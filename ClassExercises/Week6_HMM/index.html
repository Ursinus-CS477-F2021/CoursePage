<!DOCTYPE HTML>
<!--
	Editorial by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
<!-- Header !-->
	<head>
		<title>Ursinus CS 477: Artificial Intelligence And Machine Learning, Fall 2021</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<!--[if lte IE 8]><script src="../../assets/js/ie/html5shiv.js"></script><![endif]-->
		<link rel="stylesheet" href="../../assets/css/main.css" />
		<!--[if lte IE 9]><link rel="stylesheet" href="../../assets/css/ie9.css" /><![endif]-->
		<!--[if lte IE 8]><link rel="stylesheet" href="../../assets/css/ie8.css" /><![endif]-->
        <style>
        .image_off, #home:hover .image_on{
           display:none
        }
        .image_on, #home:hover .image_off{
           display:block
        }
        </style>
	</head>
	<body>

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Main -->
					<div id="main">
						<div class="inner">

							<!-- Header -->
								<header id="header">
									<a href="../../index.html" class="logo"><strong>Ursinus CS 477: Artificial Intelligence And Machine Learning, Fall 2021</strong></a>
								</header>
<!-- End Header !-->

							<!-- Content -->
								<section>
									<header class="main">
                                        <h2>Week 6: Hidden Markov Models / The Viterbi Algorithm</h2>
                                        <h3><a href = "http://www.ctralie.com">Chris Tralie</a></h3>
									</header>

									<div id="page-content">

									<h3>Markov Chains As A Bayesian Network</h3>

									<p>
										We've already seen <a href = "../Week4_Markov/">Markov chains</a>, where the probability of transitioning from one state to the next is completely independent of the previous states.  This is known as the <b>Markov state assumption</b>.  If we let the variable <code>X<sub>i</sub></code> represent the state that we're in at step <code>i</code>, then we can depict this as the following state diagram: 
									</p>

									<img src = "MarkovStateDiagram.svg" width=500>

									<p>
										This is a specific instance of a more general state diagram known as a "<a href = "https://towardsdatascience.com/introduction-to-bayesian-networks-81031eeed94e">Bayesian Network</a>."  The arrows indicate conditional dependencies.  What this diagram is saying specifically is that the "joint probability" (AND) of all states in a Markov sequence can be written as follows:
									</p>

									<h3>
										\[ p(x_1, x_2, ..., x_n) = p(x_1) \times p(x_2 | x_1) \times p(x_3 | x_2) \times ... \times p(x_n | x_{n-1})\]
									</h3>

									<p>
										Notice how we only condition on the states that are at the tail of arrows, which represents the Markov assumption graphically.
									</p>

									<h3>Hidden Markov Models</h3>
									<p>
										Markov models are applicable to time sequence data that we can observe directly, like the text strings in <a href = "../../Assignments/HW3_Markov/">assignment 3</a>.  However, there are plenty of time sequence scenarios where we can't observe what we actually want to know directly.  For example, in a <a href = "https://courses.physics.illinois.edu/ece417/fa2017/rabiner89.pdf">speech to text system</a>, we observe noisy audio data over time, but we actually want to know the text string that someone is saying.  Below is a table of some more examples of time sequences that have both a <b>hidden state</b> and an <b>observation</b>
									</p>

									<table style="width:800px;">
										<tr><td><h4>Problem</h4></td><td><h4>Hidden State</h4></td><td><h4>Observation</h4></td></tr>
										<tr>
											<td><a href = "https://courses.physics.illinois.edu/ece417/fa2017/rabiner89.pdf">Speech To Text</a></td>
											<td>Text String</td>
											<td>Noisy audio samples</td>
										</tr>
										<tr>
											<td><a href = "https://aclanthology.org/J90-2002.pdf">Machine translation</a> <p>(e.g. German to English)</p></td>
											<td>Target Language (e.g. English)</td>
											<td>Source Language (e.g. German)</td>
										</tr>
										<tr>
											<td>Handwriting Recognition</td>
											<td>Text string</td>
											<td>Images of characters</td>
										</tr>
										<tr>
											<td><a href = "https://ismir2006.ismir.net/PAPERS/ISMIR06152_Paper.pdf">Transcribing sheet music</a></td>
											<td>Symbolic representation of a musical score </td>
											<td>Images of sheet music (e.g. a <a href = "https://musiclab.chromeexperiments.com/Piano-Roll/">piano roll</a></td>
										</tr>
										<tr>
											<td>
												<a href = "https://ursinus-cs472a-s2021.github.io/CoursePage/Assignments/HW4_RhythmAnalysis/#beattrack">Audio beat tracking</a>
											</td>
											<td>
												Time series indicating when to tap the foot
											</td>
											<td>
												Audio data of music
											</td>
										</tr>
										<tr>
											<td>
												<a href = "robot.html">Robot Localization</a>
											</td>
											<td>

											</td>
										</tr>
									</table>

									<p>
										We can model problems with a hidden state and an observation using a <b>Hidden Markov Model (HMM)</b>.  Now, in addition to our sequence <b>x<SUB>1</SUB>, x<SUB>2</SUB>, ..., x<SUB>n</SUB></b>, which is what we want to know, we also have a sequence <b>y<SUB>1</SUB>, y<SUB>2</SUB>, ..., y<SUB>n</SUB></b>, in which we observe something at each state.  The Bayes net for a hidden markov model looks like this:
									</p>

									<img src = "HiddenMarkovStateDiagram.svg" width=600>
									
									<p>
										In addition to the Markov state assumption, we also have the <b>Markov observation assumption</b>; that is, each observation <b>y<SUB>i</SUB></b> only depends on the state <b>x<SUB>i</SUB></b> and is independent of all other states and all other observations.
									</p>

									<h3>Hidden Markov Likelihoods</h3>
									<p>
										We can use the <a href = "../Week5_BagOfWords/#theory">Bayesian classification framework</a> to figure out the likelihood of the hidden states given the observations.  In particular, the <b>posterior likelihood</b> of the hidden states given the observations is as follows
									</p>

									<h3>
										\[ \ell(x_1, x_2, ... x_n | y_1, y_2, ..., y_n) = p(y_1, y_2, ..., y_n | x_1, x_2, ..., x_n) p(x_1, x_2, ..., x_n) \]
									</h3>


                                    
                                </div>
						</div>
					</div>

					<!--LaTeX in Javascript!-->
					<script src="../../../../jsMath/easy/load.js"></script>
					<!--Syntax highlighting in Javascript!-->
					<script type="text/javascript" src="../../../../syntaxhighlighter/scripts/shCore.js"></script>
					<script type="text/javascript" src="../../../syntaxhighlighter/scripts/shBrushJScript.js"></script>
                    <script type="text/javascript" src="../../../../syntaxhighlighter/scripts/shBrushCpp.js"></script>
					<script type="text/javascript" src="../../../../syntaxhighlighter/scripts/shBrushXml.js"></script>
					<script type="text/javascript" src="../../../../syntaxhighlighter/scripts/shBrushMatlabSimple.js"></script>
					<script type="text/javascript" src="../../../../syntaxhighlighter/scripts/shBrushPython.js"></script>
					<link type="text/css" rel="stylesheet" href="../../../../syntaxhighlighter/styles/shCoreDefault.css"/>
					<script type="text/javascript">SyntaxHighlighter.all();</script>

<!-- Sidebar -->
					<div id="sidebar">
						<div class="inner">
							<!-- Menu -->
								<nav id="menu">
									<header class="major">
										<h2>Menu</h2>
									</header>
									<ul>
                                        <li>
											<span class="opener">General</span>
											<ul>
												<li><a href = "../../index.html#overview">Overview</a></li>
												<li><a href = "../../index.html#logistics">Technology Logistics</a></li>
												<li><a href = "../../index.html#readings">Readings</a></li>
												<li><a href = "../../index.html#deliverables">Deliverables</a></li>
												<li><a href = "../../index.html#schedule">Schedule</a></li>
												<li><a href = "../../index.html#grading">Grading</a></li>
												<li><a href = "../../index.html#environment">Classroom Environment</a></li>
												<li><a href = "../../index.html#collaboration">Collaboration Policy</a></li>
												<li><a href = "../../index.html#other">Other Resources / Policies</a></li>
											</ul> 
										</li>
										<li><a href = "../../Software/index.html">Software</a></li>
										<li><a href = "../../index.html#schedule">Schedule</a></li>
                                        <li>
											<span class="opener">Assignments</span>
											<ul>
												<li>
													<a href = "https://ursinus-cs477-f2021.github.io/Modules/Module1/Video1">HW0: Python Self Study Module</a>
												</li>
												<li>
													<a href = "../../Assignments/HW1_WelcomeToCS477">HW1: Welcome To CS 477</a>
												</li>
												<li>
													<a href = "../../Assignments/HW2_RushHour">HW2: The Rush Hour Problem</a>
												</li>
												<li>
													<a href = "../../Assignments/HW3_Markov">HW3: Markov Chains for Text Processing</a>
												</li>
											</ul>
										</li>
                                        <li>
											<span class="opener">Class Exercises / Notes</span>
											<ul>
												<li>
													<a href = "../../ClassExercises/Week1_WhatIsAI">Week 1: What Is AI?</a>
												</li>
												<li>
													<a href = "../../ClassExercises/Week1_Adventure">Week 1: Choose Your Own Adventure</a>
													<ul>
														<li><a href = "../../ClassExercises/Week1_Adventure/index.html#student">Student Adventures</a></li>
													</ul>
												</li>
												<li>
													<a href = "../../ClassExercises/Week1_COVID">Week 1: Monte Carlo COVID Simulation</a>
													<ul>
														<li><a href = "../../ClassExercises/Week1_COVID/solution.html">Solution</a></li>
													</ul>
												</li>
												<li>
													<a href = "../../ClassExercises/Week2_BasicSearch">Week 2: Blind Maze Searching</a>
												</li>
												<li>
													<a href = "../../ClassExercises/Week2_8Puzzle">Week 2: 8 Puzzle</a>
												</li>
												<li>
													<a href = "../../ClassExercises/Week3_PrioritySearch">Week 3: Uniform Cost, Greedy Best-First, and A* Search</a>
												</li>
												<li>
													<a href = "../../ClassExercises/Week4_Markov">Week 4: Markov Chains of Characters</a>
												</li>
												<li>
													<a href = "https://ursinus-cs477-f2021.github.io/Modules/Module2/Video1">Week 5: Probability Module</a>
												</li>
												<li>
													<a href = "../../ClassExercises/Week5_BagOfWords">Week 5: Bag of Words Exercise / Theory of Bayesian Classifiers</a>
													<ul>
														<li><a href = "../../ClassExercises/Week5_BagOfWords#exercise">Text Classification Exercise</a></li>
														<li><a href = "../../ClassExercises/Week5_BagOfWords#theory">Naive Bayes Theory</a></li>
													</ul>
												</li>
												<li>
													<a href = "https://ursinus-cs477-f2021.github.io/Modules/Module3/Exercise0">Week 5: Bayes Module</a>
												</li>
												<li>
													<a href = "../../ClassExercises/Week6_GradSchoolAdmissions">Week 6: Gaussian Naive Bayes And Grad School Admissions</a>
												</li>
												<li>
													<a href = "../../ClassExercises/Week6_HMM">Week 6: Hidden Markov Models / Viterbi Notes</a>
												</li>
												<li>
													<a href = "../../ClassExercises/Week6_HMM/robot.html">Week 6: Bayesian Robot Localization</a>
												</li>
											</ul>
										</li>
									</ul>
								</nav>


							<!-- Footer -->
								<footer id="footer">
									<p class="copyright">&copy; <a href = "http://www.ctralie.com">Christopher J. Tralie</a>. All rights reserved.  Contact chris.tralie@gmail.com. Design: <a href="https://html5up.net">HTML5 UP</a>.</p>
								</footer>

						</div>
					</div>

			</div>
			
            <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
            <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<!-- End Sidebar !-->

<!-- Scripts -->
			<script src="../../assets/js/jquery.min.js"></script>
			<script src="../../assets/js/skel.min.js"></script>
			<script src="../../assets/js/util.js"></script>
			<!--[if lte IE 8]><script src="../../assets/js/ie/respond.min.js"></script><![endif]-->
			<script src="../../assets/js/main.js"></script>
<!-- End Scripts -->
